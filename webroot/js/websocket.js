define(["require","autobahn"],function(e){function i(e){var t="; "+document.cookie,n=t.split("; "+e+"=");if(n.length==2)return n.pop().split(";").shift()}function s(){if(n!=null)return;this.subscribes=[],this.session=null,that=this;var e=new t.Connection({url:"ws://127.0.0.1:9090/ws",realm:"realm1",authmethods:["jwt"],onchallenge:function(t,n,i){return r}});e.onopen=function(e,t){console.log("connected session with ID "+e.id),that.session=e,that.subscribes.forEach(function(t){e.subscribe(t.topic,t.method)})},e.onclose=function(){console.log("disconnected",arguments)},e.open()}var t=e("autobahn"),n=null,r=i("Jwt");return s.prototype.subscribe=function(e){this.session==null?this.subscribes.push(e):this.session.subscribe(e.topic,e.method)},s.getInstance=function(){return n===null&&(n=new s),n},s.getInstance()});